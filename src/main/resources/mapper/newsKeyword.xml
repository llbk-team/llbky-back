<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.newstrend.dao.NewsKeywordDao">
  <!-- 뉴스 키워드 저장 -->
  <insert id="insertKeyword"
    parameterType="NewsKeyword"
    useGeneratedKeys="true"
    keyProperty="newsKeyword">
      insert into news_keyword(
        summary_id, keyword_id, metadata, created_at
      )
      values(
        #{summaryId}, #{keywordId}, cast(#{metadata} AS JSONB), NOW()
      )
  </insert>

  <!-- 특정 뉴스의 키워드 리스트 조회 -->
   <select id="selectKeywordBySummaryId"
    parameterType="int"
    resultType="NewsKeyword">
    select
      key_id, summary_id, keyword_id, metadata, created_at
    from news_keyword
    where summary_id = #{summaryId}
    order by created_at desc
  </select>
</mapper>