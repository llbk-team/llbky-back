<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.newstrend.dao.TrendInsightDao">
  <!-- LLM 생성 결과 저장 -->
   <insert id="insertTrendInsight"
    parameterType="TrendInsight">
      insert into trend_insight(
        member_id,
        base_job_title,
        start_date,
        end_date,
        insight_json
      )
      values(
        #{memberId},
        #{baseJobTitle},
        #{startDate},
        #{endDate},
        CAST(#{insightJson} AS JSONB)
      )
  </insert>

  <!-- 최신 인사이트 조회 -->
   <select id="selectLatestTrendInsight"
    resultType="TrendInsight">
      select
        trend_id,
        member_id,
        base_job_title,
        start_date,
        end_date,
        insight_json,
        created_at
      from trend_insight
      where member_id = #{memberId}
      order by created_at desc
      limit 1
  </select>

  <!-- 삭제 -->
   <delete id="deleteTrendInsight">
    delete from trend_insight
    where trend_id = #{trendId}
   </delete>
</mapper>
