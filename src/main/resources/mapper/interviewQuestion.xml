<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.interview.dao.InterviewQuestionDao">
  <!-- AI 예상 면접 질문 저장 -->
  <insert id="insertInterviewQuestion" 
          parameterType="com.example.demo.interview.entity.InterviewQuestion"
          useGeneratedKeys="true"
          keyProperty="questionId"
  >
    INSERT INTO interview_question
      (session_id, question_text)
    VALUES
      (#{sessionId}, #{questionText})
  </insert>

  <!-- 사용자 예상 면접 질문 추가 -->
  <insert id="insertCustomQuestion" parameterType="com.example.demo.interview.entity.InterviewQuestion">
    INSERT INTO interview_question
      (session_id, question_text, created_at)
    VALUES
      (#{sessionId}, #{questionText})
  </insert>

  <!-- 면접 질문 목록 조회 -->
  <select id="selectAllInterviewQuestions" resultType="com.example.demo.interview.entity.InterviewQuestion">
    SELECT question_id, 
           session_id, 
           question_text, 
           created_at
    FROM interview_question q
    JOIN interview_session s ON q.session_id = s.session_id
    WHERE s.member_id = #{memberId}
    ORDER BY q.created_at DESC
  </select>

  <!-- 면접 리포트 상세보기 시 질문 목록 조회 -->
  <select id="selectInterviewQuestionsBySessionId" resultType="com.example.demo.interview.entity.InterviewQuestion">
    SELECT question_id, 
           session_id, 
           question_text, 
           created_at
    FROM interview_question
    WHERE session_id = #{sessionId}
  </select>

</mapper>